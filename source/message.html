<!doctype html>
<HTML style="width : 350; height: 300">
<HEAD>
<TITLE></TITLE>
<SCRIPT LANGUAGE=javascript>
<!--
// Though these should be constants, MSHTML does not support const as of 2024
var args = window.dialogArguments;
var copyStatusTimeout = 5000;  // milliseconds before copy status message goes away

function handleKeyPress(e) {
	e = e || window.event;
	if(e.keyCode == 27){ // code for escape
		window.close();
	} else if (e.altKey && e.keyCode == 67) { // code for Alt+C
		onCopyButtonPress();
	}
}

function onCopyButtonPress() {
	// Copy code came from http://www.codestore.net/store.nsf/unid/DOMM-4QHQE8/
	var rng = document.body.createTextRange();
	rng.moveToElementText(messageID);
	rng.scrollIntoView();
	rng.select();
	var success = rng.execCommand("Copy");
	rng.collapse(false);
	rng.select();
	if (args) {
		if (success) {  // Notify the user about the copy result
			copyStatusDiv.innerHTML = '<p id="copyStatusText"><strong>' + args.item('copySuccessfulAlertText') + '</strong></p>';
		} else {
			copyStatusDiv.innerHTML = '<p id="copyStatusText"><strong>' + args.item('copyFailedAlertText') + '</strong></p>';
		}
		// Time out the user alert message
		setTimeout(function() {
			copyStatusDiv.innerHTML = '';
		}, copyStatusTimeout);
	}
}

function onCloseButtonPress() {
	//window.open('', '_self', '');  // Only enable if window.close() stops working in a future version, may fix.
	window.close();
}

function windowOnLoad() {
	if (args) {
		document.title = args.item('title');
		messageID.innerHTML = args.item('message');
		// If caller wants a close button
		if (args.item('closeButtonText') != null) {
			closeButton.innerHTML = args.item('closeButtonText');  // Assign the (translated) label
			closeButton.style.display = 'inline';  // Display the button
			buttonDiv.style.display = 'block';  // Display the button section
		}
		// If caller wants a copy to clip button
		if (args.item('copyButtonText') != null) {
			copyButton.innerHTML = args.item('copyButtonText');  // Assign the (translated) label
			copyButtonSpan.style.display = 'inline';  // Display the button
			copyStatusDiv.style.display = 'block';  // Display the copy status
			buttonDiv.style.display = 'block';  // Display the section
		}
	}
} 
//-->
</SCRIPT>
</HEAD>
<body tabindex='0' id='main_body' style="margin:1em" LANGUAGE=javascript onload="return windowOnLoad()" onkeydown="return handleKeyPress()" >
<div id=messageID></div>
<div id="buttonDiv" style="display: none;"><hr>
<div id="copyStatusDiv" role="status" aria-live="polite"></div>
<span id="copyButtonSpan" style="display: none;"><button id="copyButton" onclick="onCopyButtonPress();"></button>&nbsp;</span>
<span><button id="closeButton" style="display: none;" onclick="onCloseButtonPress();"></button></span>
</div>
</body>
</html>
